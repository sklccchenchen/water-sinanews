## water-sinanews
预览地址:https://sklccchenchen.github.io/water-sinanews/index.html
#### 懒加载基本原理：在图片展示到页面之前对该图片位置进行判断，如果在用户当前视野内，通过js设置其src属性为图片实际网络地址来将其展示，否则不加载，这就是懒加载，其目的是减少不必要的网络请求，提升用户体验。其中包括如下细节内容：
   一、关于判断某一图片元素是否在当前视野，基本原理为看文档滚动高度（.srollTop()）加窗口高度（$(window).height()）的值是否大于该图片节点的offset().top值，若是，则该图片在当前窗口视野内，反之，则不在；
   二、判定了图片在当前窗口视野内之后，通过修改图片src值实现对应图片加载。还可对已加载过的图片添加某一属性（如：Loaded）表示该元素已经加载，无需在后续滚动事件触发时进行不必要的判断，可节约计算资源。

#### 瀑布流原理：html将所有需要进行布局的图片设置成绝对定位，后续通过js设置各自位置实现每个元素的定位。每个元素定位具体通过以下算法实现：
   1、通过摆放元素窗口的宽度除以每个元素的宽度（每个元素等宽）得到每行布局元素数量，建立一个存放列高的数组，length为每行元素数量，用来存放当前该列的累积高度，每一项初始化为0；
   2、通过寻找列高数组中最小值得到当前最短列下标和最短列列高，按照此两个参数进行布局下一个元素至当前最短列下，同时该元素的高度加到对应列上，刷新列高数组。
   3、后续元素依次按此原理一一进行布局，即可实现瀑布流。

#### 项目实现原理：
   第一步：getData函数发送ajax请求获得一页10条数据，将该页数据拼装成DOM节点append到html中
   第二步：一页每一个元素加载后按照瀑布流原理对其进行摆放渲染，当前元素最大高度下布置一个用来判断是否页面滚到最底部的元素，如<div class="loaded"></div>
   第三步：窗口滚动至loaded元素展现在当前视野并且ajax请求下页数据还未到来触发事件继续获取下页data，并按照前述步骤拼装渲染。
   总之就是每次获得一页部分data进行渲染，用户滚动至当前data完全展示之后重新获取新的数据，在保证了用户体验的前提下，最大程度节约网络资源。
